// knuckles 0.0.1 | (c) 2013 Ryan Niemeyer |  http://www.opensource.org/licenses/mit-license
!function(a){var b=this||(0,eval)("this"),c=(b.document,b.navigator,b.JSON),d=(b.ko,b.require),e=b.define;!function(a){"function"==typeof e&&e.amd?e(["exports","knockout","jquery"],a):a(b.Knuckles={},b.ko,b.jQuery)}(function(e,f,g){var e=b.Knuckles=e||{};e.version="##VERSION##",Date.prototype.toISOString||(Date.prototype.toISOString=function(){function a(a){return 10>a?"0"+a:a}return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z"});var h=Array.prototype,i=Object.prototype,j=Function.prototype,k={},l=function(){},m=h.push,n=h.slice,o=(h.concat,i.toString),p=i.hasOwnProperty,q=h.forEach,r=h.map;h.reduce,h.reduceRight,h.filter,h.every,h.some,h.indexOf,h.lastIndexOf,Array.isArray,Object.keys,j.bind;var s=function(a,b){return p.call(a,b)},t=e.each=function(a,b,c){if(null!=a)if(q&&a.forEach===q)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,e=a.length;e>d;d++)if(b.call(c,a[d],d,a)===k)return}else for(var f in a)if(s(a,f)&&b.call(c,a[f],f,a)===k)return},u=e.map=function(a,b,c){var d=[];return null==a?d:r&&a.map===r?a.map(b,c):(t(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)},v=e.extend=function(a){return t(n.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},w=f.observable,x=f.observableArray,y=f.computed,z=(f.utils.unwrapObservable,f.isObservable,f.isWriteableObservable),A=(f.isComputed,f.utils.registerEventHandler,f.bindingHandlers,f.applyBindings),B=(f.applyBindingsToNode,f.toJS),C=f.toJSON,D=function(b){return b===a||null===b||""===b},E=function(a){return"[object Array]"===o.call(a)},F=function(a){return"string"==typeof a},G=function(a){return"function"==typeof a},H=function(a,b){throw new Error(""+(b?b+": ":"")+a)},I=function(a){switch(arguments.length){case 1:console.log(a);break;case 0:return;default:console.log(n.apply(arguments).split(" "))}},J=g.Deferred,K=g.when,L=e.container=function(){function b(a){var b=a.name,c=a.deps||[],d=a.factory,e=a.cache!==!1;return G(d)?(b||(b=d.name)||H("config object must provide a resource name",12345),s(f,b)?(I("module registry for "+b+" called more than once"),void 0):(f[b]={name:b,deps:c,factory:d,storeInCache:e},void 0)):(H("config object must provide factory function",1234),void 0)}function c(b,e){var h=J(),i=g[b];if(i!==a)return h.resolve(i),h;var j=f[b];if(j===a)e!==!0&&G(d)?d([b],function(){var a=c(b,!1);a.done(function(a){h.resolve(a)})}):(h.fail("Resource '"+b+"' was not found"),H("Resource '"+b+"' was not found",1234));else{var k=K.apply(null,u(j.deps,c));k.done(function(){var a=j.factory.apply(null,arguments);j.storeInCache&&(g[b]=a),h.resolve(a)}).fail(function(a){H(a)})}return h}function e(b,d){var e,f,h,i={},j={},k=l;if(E(b)&&(G(d)||d===a))e=b,h=d;else if(F(b)&&(G(d)||d===a))e=[b],h=d;else{i=b.mock||{},e=b.deps||[],h=b.callback||d||l,k=function(){var b;for(b in i)delete g[b],j[b]!==a&&(g[b]=j[b])};for(f in i)g[f]!==a&&(j[f]=g[f]),g[f]=i[f]}return K.apply(null,u(e,c)).done(h||l).fail(function(a){H(a)}).always(k).promise()}var f={},g={};return{define:b,use:e,clearCache:function(b){b===a?g={}:delete g[b]},clearRegistry:function(b){b===a?f={}:delete f[b]},isRegistered:function(a){return F(a)?s(f,a):(H("expecting parameter 'name' to be a string"),void 0)}}}();v(e,{use:L.use,run:L.use,define:L.define});var M=e.formatting=function(){var b=function(b,c){return c===a&&(c=e.formatting.currency.defaultSymbol),c+(+b).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")};b.defaultSymbol="$";var c=function(a){var b=((new Date).getTime()-a.getTime())/1e3,c=Math.floor(b/86400);return 0===c&&(60>b&&"just now"||120>b&&"a minute ago"||3600>b&&Math.floor(b/60)+" minutes ago"||7200>b&&"an hour ago"||86400>b&&Math.floor(b/3600)+" hours ago")||1===c&&"yesterday"||31>c&&c+" days ago"||60>c&&"one month ago"||365>c&&Math.ceil(c/30)+" months ago"||730>c&&"one year ago"||Math.ceil(c/365)+" years ago"};return{currency:b,timeAgo:c}}();!function(b){var c={pad:function(a,b){var c=1,d="";if(1>b)return"";for(var e=0;b>e;e++)c*=10,d+="0";var f=d+a;return f=f.substring(f.length-b)},convertTo12Hour:function(a){return 0===a%12?12:a%12},i18n:{dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}},d=function(d,e){e||(e=b.date.default);var f=-1!==e.indexOf("a")||-1!==e.indexOf("A"),g=[];g.d=d.getDate(),g.dd=c.pad(g.d,2),g.ddd=c.i18n.shortDayNames[d.getDay()],g.dddd=c.i18n.dayNames[d.getDay()],g.M=d.getMonth()+1,g.MM=c.pad(g.M,2),g.MMM=c.i18n.shortMonthNames[g.M-1],g.MMMM=c.i18n.monthNames[g.M-1],g.yyyy=d.getFullYear(),g.yyy=c.pad(g.yyyy,2)+"y",g.yy=c.pad(g.yyyy,2),g.y="y",g.H=d.getHours(),g.hh=c.pad(f?c.convertTo12Hour(g.H):g.H,2),g.h=f?c.convertTo12Hour(g.H):g.H,g.HH=c.pad(g.H,2),g.m=d.getMinutes(),g.mm=c.pad(g.m,2),g.s=d.getSeconds(),g.ss=c.pad(g.s,2),g.z=d.getMilliseconds(),g.zz=g.z+"z",g.zzz=c.pad(g.z,3),g.ap=g.H<12?"am":"pm",g.a=g.H<12?"am":"pm",g.AP=g.H<12?"AM":"PM",g.A=g.H<12?"AM":"PM";for(var h=0,i="",j="";h<e.length;){for(j=e.charAt(h);h+1<e.length&&g[j+e.charAt(h+1)]!==a;)j+=e.charAt(++h);i+=g[j]!==a?g[j]:j,h++}return i},e={unpad:function(a){for(var b=a;b.length>1&&"0"===b[0];)b=b.substring(1,b.length);return b},parseInt:function(a){return parseInt(this.unpad(a),10)}},f=function(b,c){var d=new Date(2e3,0,1),f=[];f.d="([0-9][0-9]?)",f.dd="([0-9][0-9])",f.M="([0-9][0-9]?)",f.MM="([0-9][0-9])",f.yyyy="([0-9][0-9][0-9][0-9])",f.yyy="([0-9][0-9])[y]",f.yy="([0-9][0-9])",f.H="([0-9][0-9]?)",f.hh="([0-9][0-9])",f.h="([0-9][0-9]?)",f.HH="([0-9][0-9])",f.m="([0-9][0-9]?)",f.mm="([0-9][0-9])",f.s="([0-9][0-9]?)",f.ss="([0-9][0-9])",f.z="([0-9][0-9]?[0-9]?)",f.zz="([0-9][0-9]?[0-9]?)[z]",f.zzz="([0-9][0-9][0-9])",f.ap="([ap][m])",f.a="([ap][m])",f.AP="([AP][M])",f.A="([AP][M])";for(var g=0,h="",i=new Array(""),j="";g<c.length;){for(j=c.charAt(g);g+1<c.length&&f[j+c.charAt(g+1)]!==a;)j+=c.charAt(++g);f[j]!==a?(h+=f[j],i[i.length]=j):h+=j,g++}var k=new RegExp(h),l=b.match(k);if(l===a||l.length!==i.length)return a;for(g=0;g<i.length;g++)if(""!==i[g])switch(i[g]){case"yyyy":case"yyy":d.setYear(e.parseInt(l[g]));break;case"yy":d.setYear(2e3+e.parseInt(l[g]));break;case"MM":case"M":d.setMonth(e.parseInt(l[g])-1);break;case"dd":case"d":d.setDate(e.parseInt(l[g]));break;case"hh":case"h":case"HH":case"H":d.setHours(e.parseInt(l[g]));break;case"mm":case"m":d.setMinutes(e.parseInt(l[g]));break;case"ss":case"s":d.setSeconds(e.parseInt(l[g]));break;case"zzz":case"zz":case"z":d.setMilliseconds(e.parseInt(l[g]));break;case"AP":case"A":case"ap":case"a":("PM"===l[g]||"pm"===l[g])&&d.getHours()<12&&d.setHours(d.getHours()+12),"AM"!==l[g]&&"am"!==l[g]||12!==d.getHours()||d.setHours(0)}return d};v(b,{date:v(d,{names:c.i18n,parse:f,"default":"yyyy-MM-dd"}),datetime:v(function(a,c){return b.date(a,c||b.datetime.default)},{"default":"yyyy-MM-dd HH:mm:ss"})})}(M);var N={};N.fromJS=function(b,c){var d;for(d in c)!function(c,d,e){e!==a&&(z(e)?b[c](d):b[c]=d)}(d,c[d],b[d])},N.toJS=B,N.toJSON=C,e.mapping=N,function(b){var c=function(a){return"function"==typeof a?a():a};b.rules={},b.rules.required={validator:function(b,c){var d,e=/^\s+|\s+$/g;return b===a||null===b?!c:(d=b,"string"==typeof b&&(d=b.replace(e,"")),c?(d+"").length>0:!0)},message:"This field is required."},b.rules.min={validator:function(a,b){return D(a)||a>=b},message:"Please enter a value greater than or equal to {0}."},b.rules.max={validator:function(a,b){return D(a)||b>=a},message:"Please enter a value less than or equal to {0}."},b.rules.minLength={validator:function(a,b){return D(a)||a.length>=b},message:"Please enter at least {0} characters."},b.rules.maxLength={validator:function(a,b){return D(a)||a.length<=b},message:"Please enter no more than {0} characters."},b.rules.pattern={validator:function(a,b){return D(a)||null!==a.toString().match(b)},message:"Please check this value."},b.rules.step={validator:function(a,b){return D(a)||0===100*a%(100*b)},message:"The value must increment by {0}"},b.rules.email={validator:function(a,b){return b?D(a)||b&&/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a):!0},message:"Please enter a proper email address"},b.rules.date={validator:function(a,b){return b?D(a)||b&&!/Invalid|NaN/.test(new Date(a)):!0},message:"Please enter a proper date"},b.rules.dateISO={validator:function(a,b){return b?D(a)||b&&/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(a):!0},message:"Please enter a proper date"},b.rules.number={validator:function(a,b){return b?D(a)||b&&/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(a):!0},message:"Please enter a number"},b.rules.digit={validator:function(a,b){return b?D(a)||b&&/^\d+$/.test(a):!0},message:"Please enter a digit"},b.rules.phoneUS={validator:function(a,b){return b?"string"!=typeof a?!1:D(a)?!0:(a=a.replace(/\s+/g,""),b&&a.length>9&&a.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)):!0},message:"Please specify a valid phone number"},b.rules.equal={validator:function(a,b){var d=b;return a===c(d)},message:"Values must equal"},b.rules.notEqual={validator:function(a,b){var d=b;return a!==c(d)},message:"Please choose another value."},b.rules.unique={validator:function(b,d){var e=c(d.collection),g=c(d.externalValue),h=0;return b&&e?(f.utils.arrayFilter(f.utils.unwrapObservable(e),function(a){b===(d.valueAccessor?d.valueAccessor(a):a)&&h++}),(g!==a&&b!==g?1:2)>h):!0},message:"Please make sure the value is unique."};var d=v({},{});w.fn.validatable=function(){v(this,d,{rules:[]}),this.isValid=function(){}.bind(this)}}(e.validation||(e.validation={})),e.service={define:L.define,remove:L.remove},e.extender={define:function(a){var b=a.name,c=a.deps||[],d=a.fn||{},e=a.static||{},f=G(d),g=G(e),h=a.defaults||{},i=a.cache===!0;return L.define({name:b,deps:c,cache:i,factory:function(){var a=n.call(arguments);a.unshift(h);var c=function(b){return a[0]=v({},h,b),{fn:f?d.apply(this,a):d,"static":g?e.apply(this,a):e}};return v(c,{extenderName:b})}})},remove:L.remove},e.viewModel={},e.ViewModelBase=function(){},e.viewModel.fn={$populate:function(a){return N.fromJS(this,a)},$serialize:function(){return N.toJS(this)},$jsonIgnore:function(){}};var O=function(a){var b,c=[];for(b in a)s(a,b)&&c.push(b);return c};v(e.viewModel,{define:function(b){var c=b.name,d=b.deps||[],f=b.fn||{},g=b.factory,h=b.extenders||{},i=[].concat(O(h)).concat(d);return L.define({name:c,deps:i,factory:function(){var b=[a],c=n.call(arguments,0,d.length);m.apply(b,n.call(arguments,d.length));var i=function(a){return b[0]=a,g.apply(this,b)};return i.fn=i.prototype,v(i.fn,e.viewModel.fn),t(c,function(a){var b=h[a.extenderName],c=a(b);v(i,c.static),v(i.fn,c.fn)}),v(i.fn,f),i}})},remove:L.remove}),e.service.define({name:"$http",deps:[],factory:function(){var a=function(a){return g.ajax(v(a,{data:"json"!==a.dataType||a.processData?a.data:c.stringify(a.data)}))};return v(a,{POST_OPTIONS:{contentType:"application/json; charset=UTF-8",dataType:"json",processData:!1,type:"POST"},GET_OPTIONS:v({},a.POST_OPTIONS,{type:"GET"}),PUT_OPTIONS:v({},a.POST_OPTIONS,{type:"PUT"}),DELETE_OPTIONS:v({},a.POST_OPTIONS,{type:"DELETE"}),post:function(b){return a(v({},a.POST_OPTIONS,b))},get:function(b){return a(v({},a.GET_OPTIONS,b))},put:function(b){return a(v({},a.PUT_OPTIONS,b))},"delete":function(b){return a(v({},a.DELETE_OPTIONS,b))}})}}),e.service.define({name:"$deferred",deps:[],factory:function(){return J.when=K,J}}),e.service.define({name:"$async",deps:["$deferred"],factory:function(a){function c(a,b){var c;return k++,c=h(function(){delete j[c],e(a)},b||0),j[c]=!0,c}function d(a){return j[a]?(delete j[a],i(a),e(l),!0):!1}function e(a){try{a.apply(null,n.call(arguments,1))}finally{if(k--,0===k)for(;m.length;)try{m.pop()()}catch(b){H(b)}}}function f(b,d){var e,f,g=a();return e=c(function(){try{g.resolve(b())}catch(a){g.fail(a),H(a)}},d),f=function(){delete o[g.$$timeoutId]},g.$$timeoutId=e,o[e]=g,g.always(f),g}function g(a,b){function c(){a.apply(this,arguments),f(c,b)}f(c,b)}var h=b.setTimeout,i=b.clearTimeout,j={},k=0,m=[],o={};return{defer:c,cancel:d,timeout:f,interval:g}}}),e.service.define({name:"$localStorage",deps:[],factory:function(){return localStorage}}),e.service.define({name:"$bind",deps:[],factory:function(){return A}});var P="__ko_typed_array_ctor__",Q="__ko_typed_array_underlying__",R=function(a){return n.call(a,0).sort()},S=function(a,b){var c,d=a.length,e=[];for(c=0;d>c;c++)e.push(new b(a[c]));return e},T={splice:function(){var b,c=this[Q],d=!1;arguments[2]===a||arguments[2]instanceof this[P]||(d=!0,b=S(R(arguments).slice(2),c[P]),b.unshift(arguments[0],arguments[1]));var e=c.peek();c.valueWillMutate();var f=e.splice.apply(e,d?b:arguments);return c.valueHasMutated(),f}};t(["remove","removeAll","destroy","destroyAll","replace"],function(a){T[a]=function(){var b=this[Q];b[a].apply(b,arguments)}}),t(["push","unshift"],function(b){T[b]=function(){var c,d=this[Q],e=!1;arguments[0]===a||arguments[0]instanceof d[P]||(e=!0,c=S(R(arguments),d[P]));var f=d.peek();d.valueWillMutate();var g=f[b].apply(f,e?c:arguments);return d.valueHasMutated(),g}}),x.fn.ofType=function(a){var b=this,c=y({read:b,write:function(a){var c,d=!1;a&&a.length>0&&!(a[0]instanceof b[P])&&(d=!0,c=S(a,b[P])),b(d?c:a)}});return v(c,x.fn,T),b[P]=a,c[Q]=b,c}})}();